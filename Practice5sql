-- 문제 1.
SELECT FIRST_NAME, MANAGER_ID,COMMISSION_PCT, SALARY
FROM EMPLOYEES
WHERE COMMISSION_PCT IS NOT NULL 
AND SALARY > 3000;

-- 문제 2.
SELECT PHONE_NUMBER
FROM EMPLOYEES;
SELECT EMPLOYEE_ID, FIRST_NAME, SALARY,
        TO_CHAR(HIRE_DATE,'YYYY-MM-DD DAY'),
        SUBSTR(PHONE_NUMBER,3,3)||'-'||SUBSTR(PHONE_NUMBER,7,3)||'-'||SUBSTR(PHONE_NUMBER,11),
        DEPARTMENT_ID
FROM EMPLOYEES e
WHERE SALARY IN (SELECT MAX(SALARY)
                FROM EMPLOYEES d
                WHERE e.DEPARTMENT_ID = d.DEPARTMENT_ID);
                
-- 문제 3. 9건
SELECT e.MANAGER_ID,e.FIRST_NAME, AVG(SALARY),MIN(SALARY),
        MAX(SALARY)
FROM EMPLOYEES e JOIN(SELECT MANAGER_ID,FIRST_NAME,AVG(SALARY),MIN(SALARY),MAX(SALARY)
                    FROM EMPLOYEES
                    GROUP BY MANAGER_ID,FIRST_NAME
                        HAVING AVG(SALARY)>=5000) d
ON e.EMPLOYEE_ID = d.MANAGER_ID
AND e.HIRE_DATE>'2015/12/31'
GROUP BY e.MANAGER_ID,e.FIRST_NAME;




SELECT e.MANAGER_ID, 
      (SELECT e2.FIRST_NAME FROM EMPLOYEES e2 WHERE e.MANAGER_ID = e2.EMPLOYEE_ID) AS FIRST_NAME,
      ROUND(AVG(e.SALARY)) AS AVERAGE_SALARY,
      MIN(e.SALARY) AS MIN_SALARY,
      MAX(e.SALARY) AS MAX_SALARY
FROM EMPLOYEES e 
WHERE TO_NUMBER(TO_CHAR(e.HIRE_DATE, 'YYYY')) >= 2005
GROUP BY MANAGER_ID
HAVING ROUND(AVG(e.SALARY)) >= 5000
ORDER BY AVERAGE_SALARY DESC;



SELECT DISTINCT *
FROM (SELECT MANAGER_ID,FIRST_NAME,AVG(SALARY),
        MIN(SALARY),MAX(SALARY) FROM EMPLOYEES)
;




